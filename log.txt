torch.Size([6, 3, 32, 32]) torch.Size([6, 3, 32, 32])
No decomposition model weights loaded, start training...
No diffusion model weights loaded, start training...
Decomposite params: 0.02 M
Diffusion params: 79.12 M
Total params: 79.14 M
  0%|          | 0/250 [00:00<?, ?it/s]/home/klawens/anaconda3/envs/ddpm/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:90: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
[2023-11-04 14:48:32,806] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-11-04 14:48:36,374] torch._dynamo.eval_frame: [DEBUG] skipping removeHandler /home/klawens/anaconda3/envs/ddpm/lib/python3.10/logging/__init__.py
[2023-11-04 14:48:36,374] torch._dynamo.eval_frame: [DEBUG] skipping _remove /home/klawens/anaconda3/envs/ddpm/lib/python3.10/_weakrefset.py
[2023-11-04 14:48:36,374] torch._dynamo.eval_frame: [DEBUG] skipping _handle_existing_loggers /home/klawens/anaconda3/envs/ddpm/lib/python3.10/logging/config.py
[2023-11-04 14:48:36,374] torch._dynamo.eval_frame: [DEBUG] skipping set_loggers_level /home/klawens/anaconda3/envs/ddpm/lib/python3.10/site-packages/torch/_dynamo/logging.py
[2023-11-04 14:48:42,101] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
  0%|          | 0/250 [00:35<?, ?it/s, epoch=0, loss: =38.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  0%|          | 1/250 [00:35<2:26:22, 35.27s/it, epoch=0, loss: =38.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  0%|          | 1/250 [00:37<2:26:22, 35.27s/it, epoch=0, loss: =43.8, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  1%|          | 2/250 [00:37<1:05:39, 15.88s/it, epoch=0, loss: =43.8, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  1%|          | 2/250 [00:40<1:05:39, 15.88s/it, epoch=0, loss: =41.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  1%|          | 3/250 [00:40<40:29,  9.84s/it, epoch=0, loss: =41.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]    1%|          | 3/250 [00:42<40:29,  9.84s/it, epoch=0, loss: =41, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]    2%|▏         | 4/250 [00:42<28:08,  6.86s/it, epoch=0, loss: =41, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  2%|▏         | 4/250 [00:44<28:08,  6.86s/it, epoch=0, loss: =39.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  2%|▏         | 5/250 [00:44<21:19,  5.22s/it, epoch=0, loss: =39.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  2%|▏         | 5/250 [00:47<21:19,  5.22s/it, epoch=0, loss: =40.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  2%|▏         | 6/250 [00:47<17:12,  4.23s/it, epoch=0, loss: =40.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  2%|▏         | 6/250 [00:49<17:12,  4.23s/it, epoch=0, loss: =36.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  3%|▎         | 7/250 [00:49<14:35,  3.60s/it, epoch=0, loss: =36.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  3%|▎         | 7/250 [00:51<14:35,  3.60s/it, epoch=0, loss: =35.8, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  3%|▎         | 8/250 [00:51<12:52,  3.19s/it, epoch=0, loss: =35.8, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  3%|▎         | 8/250 [00:54<12:52,  3.19s/it, epoch=0, loss: =38.8, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  4%|▎         | 9/250 [00:54<11:42,  2.92s/it, epoch=0, loss: =38.8, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  4%|▎         | 9/250 [00:56<11:42,  2.92s/it, epoch=0, loss: =33.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  4%|▍         | 10/250 [00:56<10:55,  2.73s/it, epoch=0, loss: =33.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  4%|▍         | 10/250 [00:58<10:55,  2.73s/it, epoch=0, loss: =31.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  4%|▍         | 11/250 [00:58<10:21,  2.60s/it, epoch=0, loss: =31.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  4%|▍         | 11/250 [01:01<10:21,  2.60s/it, epoch=0, loss: =31.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  5%|▍         | 12/250 [01:01<09:58,  2.51s/it, epoch=0, loss: =31.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  5%|▍         | 12/250 [01:03<09:58,  2.51s/it, epoch=0, loss: =29, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]    5%|▌         | 13/250 [01:03<09:41,  2.45s/it, epoch=0, loss: =29, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  5%|▌         | 13/250 [01:05<09:41,  2.45s/it, epoch=0, loss: =32.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  6%|▌         | 14/250 [01:05<09:28,  2.41s/it, epoch=0, loss: =32.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  6%|▌         | 14/250 [01:08<09:28,  2.41s/it, epoch=0, loss: =29.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  6%|▌         | 15/250 [01:08<09:28,  2.42s/it, epoch=0, loss: =29.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  6%|▌         | 15/250 [01:10<09:28,  2.42s/it, epoch=0, loss: =28.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  6%|▋         | 16/250 [01:10<09:18,  2.39s/it, epoch=0, loss: =28.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  6%|▋         | 16/250 [01:12<09:18,  2.39s/it, epoch=0, loss: =31.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  7%|▋         | 17/250 [01:12<09:11,  2.37s/it, epoch=0, loss: =31.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  7%|▋         | 17/250 [01:15<09:11,  2.37s/it, epoch=0, loss: =28.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  7%|▋         | 18/250 [01:15<09:05,  2.35s/it, epoch=0, loss: =28.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  7%|▋         | 18/250 [01:17<09:05,  2.35s/it, epoch=0, loss: =27.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  8%|▊         | 19/250 [01:17<09:00,  2.34s/it, epoch=0, loss: =27.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  8%|▊         | 19/250 [01:19<09:00,  2.34s/it, epoch=0, loss: =26.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  8%|▊         | 20/250 [01:19<08:56,  2.33s/it, epoch=0, loss: =26.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  8%|▊         | 20/250 [01:21<08:56,  2.33s/it, epoch=0, loss: =28, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]    8%|▊         | 21/250 [01:21<08:52,  2.33s/it, epoch=0, loss: =28, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  8%|▊         | 21/250 [01:24<08:52,  2.33s/it, epoch=0, loss: =26.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  9%|▉         | 22/250 [01:24<08:49,  2.32s/it, epoch=0, loss: =26.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  9%|▉         | 22/250 [01:26<08:49,  2.32s/it, epoch=0, loss: =24.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  9%|▉         | 23/250 [01:26<08:46,  2.32s/it, epoch=0, loss: =24.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]  9%|▉         | 23/250 [01:28<08:46,  2.32s/it, epoch=0, loss: =25.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 10%|▉         | 24/250 [01:28<08:43,  2.32s/it, epoch=0, loss: =25.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 10%|▉         | 24/250 [01:31<08:43,  2.32s/it, epoch=0, loss: =26.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 10%|█         | 25/250 [01:31<08:41,  2.32s/it, epoch=0, loss: =26.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 10%|█         | 25/250 [01:33<08:41,  2.32s/it, epoch=0, loss: =23.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 10%|█         | 26/250 [01:33<08:47,  2.36s/it, epoch=0, loss: =23.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 10%|█         | 26/250 [01:35<08:47,  2.36s/it, epoch=0, loss: =27.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 11%|█         | 27/250 [01:35<08:42,  2.34s/it, epoch=0, loss: =27.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 11%|█         | 27/250 [01:38<08:42,  2.34s/it, epoch=0, loss: =26.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 11%|█         | 28/250 [01:38<08:38,  2.33s/it, epoch=0, loss: =26.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 11%|█         | 28/250 [01:40<08:38,  2.33s/it, epoch=0, loss: =24.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 12%|█▏        | 29/250 [01:40<08:34,  2.33s/it, epoch=0, loss: =24.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 12%|█▏        | 29/250 [01:42<08:34,  2.33s/it, epoch=0, loss: =24.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 12%|█▏        | 30/250 [01:42<08:31,  2.32s/it, epoch=0, loss: =24.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 12%|█▏        | 30/250 [01:45<08:31,  2.32s/it, epoch=0, loss: =23.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 12%|█▏        | 31/250 [01:45<08:28,  2.32s/it, epoch=0, loss: =23.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 12%|█▏        | 31/250 [01:47<08:28,  2.32s/it, epoch=0, loss: =26.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 13%|█▎        | 32/250 [01:47<08:25,  2.32s/it, epoch=0, loss: =26.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 13%|█▎        | 32/250 [01:49<08:25,  2.32s/it, epoch=0, loss: =27, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]   13%|█▎        | 33/250 [01:49<08:22,  2.32s/it, epoch=0, loss: =27, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 13%|█▎        | 33/250 [01:52<08:22,  2.32s/it, epoch=0, loss: =25.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 14%|█▎        | 34/250 [01:52<08:20,  2.32s/it, epoch=0, loss: =25.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 14%|█▎        | 34/250 [01:54<08:20,  2.32s/it, epoch=0, loss: =25.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 14%|█▍        | 35/250 [01:54<08:17,  2.32s/it, epoch=0, loss: =25.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 14%|█▍        | 35/250 [01:56<08:17,  2.32s/it, epoch=0, loss: =27.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 14%|█▍        | 36/250 [01:56<08:15,  2.32s/it, epoch=0, loss: =27.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 14%|█▍        | 36/250 [01:59<08:15,  2.32s/it, epoch=0, loss: =27.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 15%|█▍        | 37/250 [01:59<08:13,  2.32s/it, epoch=0, loss: =27.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 15%|█▍        | 37/250 [02:01<08:13,  2.32s/it, epoch=0, loss: =27.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 15%|█▌        | 38/250 [02:01<08:19,  2.35s/it, epoch=0, loss: =27.3, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 15%|█▌        | 38/250 [02:03<08:19,  2.35s/it, epoch=0, loss: =29, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]   16%|█▌        | 39/250 [02:03<08:14,  2.34s/it, epoch=0, loss: =29, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 16%|█▌        | 39/250 [02:06<08:14,  2.34s/it, epoch=0, loss: =26.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 16%|█▌        | 40/250 [02:06<08:10,  2.33s/it, epoch=0, loss: =26.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 16%|█▌        | 40/250 [02:08<08:10,  2.33s/it, epoch=0, loss: =25.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 16%|█▋        | 41/250 [02:08<08:06,  2.33s/it, epoch=0, loss: =25.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 16%|█▋        | 41/250 [02:10<08:06,  2.33s/it, epoch=0, loss: =26.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 17%|█▋        | 42/250 [02:10<08:03,  2.32s/it, epoch=0, loss: =26.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 17%|█▋        | 42/250 [02:13<08:03,  2.32s/it, epoch=0, loss: =23.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 17%|█▋        | 43/250 [02:13<08:00,  2.32s/it, epoch=0, loss: =23.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 17%|█▋        | 43/250 [02:15<08:00,  2.32s/it, epoch=0, loss: =23.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 18%|█▊        | 44/250 [02:15<07:57,  2.32s/it, epoch=0, loss: =23.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 18%|█▊        | 44/250 [02:17<07:57,  2.32s/it, epoch=0, loss: =23, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]   18%|█▊        | 45/250 [02:17<07:55,  2.32s/it, epoch=0, loss: =23, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 18%|█▊        | 45/250 [02:20<07:55,  2.32s/it, epoch=0, loss: =26.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 18%|█▊        | 46/250 [02:20<07:52,  2.32s/it, epoch=0, loss: =26.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 18%|█▊        | 46/250 [02:22<07:52,  2.32s/it, epoch=0, loss: =23.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 19%|█▉        | 47/250 [02:22<07:50,  2.32s/it, epoch=0, loss: =23.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 19%|█▉        | 47/250 [02:24<07:50,  2.32s/it, epoch=0, loss: =24.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 19%|█▉        | 48/250 [02:24<07:47,  2.32s/it, epoch=0, loss: =24.4, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 19%|█▉        | 48/250 [02:27<07:47,  2.32s/it, epoch=0, loss: =22.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 20%|█▉        | 49/250 [02:27<07:53,  2.36s/it, epoch=0, loss: =22.5, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 20%|█▉        | 49/250 [02:29<07:53,  2.36s/it, epoch=0, loss: =24.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 20%|██        | 50/250 [02:29<07:48,  2.34s/it, epoch=0, loss: =24.7, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 20%|██        | 50/250 [02:31<07:48,  2.34s/it, epoch=0, loss: =23.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 20%|██        | 51/250 [02:31<07:44,  2.33s/it, epoch=0, loss: =23.6, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 20%|██        | 51/250 [02:34<07:44,  2.33s/it, epoch=0, loss: =25.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 21%|██        | 52/250 [02:34<07:41,  2.33s/it, epoch=0, loss: =25.1, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 21%|██        | 52/250 [02:36<07:41,  2.33s/it, epoch=0, loss: =22.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 21%|██        | 53/250 [02:36<07:37,  2.32s/it, epoch=0, loss: =22.9, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 21%|██        | 53/250 [02:38<07:37,  2.32s/it, epoch=0, loss: =25.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 22%|██▏       | 54/250 [02:38<07:35,  2.32s/it, epoch=0, loss: =25.2, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5] 22%|██▏       | 54/250 [02:41<07:35,  2.32s/it, epoch=0, loss: =25, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]   22%|██▏       | 55/250 [02:41<07:32,  2.32s/it, epoch=0, loss: =25, img shape: =torch.Size([6, 3, 32, 32]), LR=5e-5]